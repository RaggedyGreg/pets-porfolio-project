"use strict";(self.webpackChunkpet_manager=self.webpackChunkpet_manager||[]).push([[341],{341:(e,t,r)=>{r.r(t),r.d(t,{default:()=>B});var a=r(5043),i=r(2721);var s=r(8093),n=r(1637),o=r(1e3),l=r(4194),d=r(490),c=r(1906),h=r(8911),g=r(3336),u=r(4600),p=r(1787),m=r(3845),x=r(9650),b=r(1806),A=r(4882),j=r(8076),f=r(2420),S=r(3460),w=r(8736),y=r(6360),k=r(8242),v=r(835),C=r(4117),P=r(4319),I=r(579);const O="pet-of-the-day",F=e=>{let{maxPets:t}=e;const r=(0,v.Zp)(),{t:i}=(0,C.Bd)();(0,a.useEffect)((()=>{if(t>0){let e=(0,P.Ri)(O);e||(e=String(Math.floor(Math.random()*t)),(0,P.TV)(O,e,(()=>{const e=new Date,t=new Date(e);t.setHours(24,0,0,0);const r=t.getTime()-e.getTime();return Math.floor(r/1e3)})()))}}),[t]);return(0,I.jsx)(c.A,{variant:"contained",onClick:()=>{r("detail/".concat((0,P.Ri)(O)))},children:i("petToday.text")})};var E=r(1801),R=r(1733),N=r(1524);const T=(0,a.memo)((e=>{let{pet:t,onRowClick:r}=e;const{t:a}=(0,C.Bd)();return(0,I.jsxs)(j.A,{hover:!0,sx:{cursor:"pointer"},onClick:()=>{r(t.id)},tabIndex:0,role:"button",onKeyPress:e=>{"Enter"===e.key&&r(t.id)},"aria-label":a("home.table.rowAria","View details for {{name}}",{name:t.name}),children:[(0,I.jsx)(f.A,{component:"th",scope:"row",children:t.name}),(0,I.jsx)(f.A,{align:"right",children:(0,I.jsx)("img",{height:40,src:(0,P.Ny)(t.kind),alt:a("home.table.kindIcon","{{kind}} icon",{kind:t.kind}),onError:e=>{let{currentTarget:t}=e;t.onerror=null,t.src=R.mX}})}),(0,I.jsx)(f.A,{align:"right",children:t.weight}),(0,I.jsx)(f.A,{align:"right",children:t.height}),(0,I.jsx)(f.A,{align:"right",children:t.length}),(0,I.jsx)(f.A,{align:"right","data-testid":"health",children:(0,I.jsx)(N.X,{pet:t})})]})}),((e,t)=>e.pet.id===t.pet.id&&e.pet.name===t.pet.name&&e.pet.weight===t.pet.weight&&e.pet.height===t.pet.height&&e.pet.length===t.pet.length&&e.pet.kind===t.pet.kind));T.displayName="PetTableRow";const J="paginationModel",L="sortModel",M="searchQuery",z="petTypeFilter",B=()=>{const e=(0,v.Zp)(),{t:t}=(0,C.Bd)(),[r,P]=(0,a.useState)({pageSize:5,page:0}),[O,R]=(0,a.useState)({sortField:"",sortOrder:"desc"}),[N,B]=(0,a.useState)(""),[D,W]=(0,a.useState)([]),{data:q,loading:H,error:V}=function(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;const[n,o]=(0,a.useState)(null),[l,d]=(0,a.useState)(!0),[c,h]=(0,a.useState)(null),[g,u]=(0,a.useState)(0),p=(0,a.useRef)(null);return(0,a.useEffect)((()=>((async()=>{p.current&&p.current.abort(),p.current=new AbortController;const e=p.current.signal;d(!0),h(null);try{if(await new Promise(((t,r)=>{const a=setTimeout(t,300);e.addEventListener("abort",(()=>{clearTimeout(a),r(new Error("Request aborted"))}))})),e.aborted)throw new Error("Request aborted");const a=(0,i.WO)(t.page,t.pageSize,r.sortField,r.sortOrder);e.aborted||(o({rows:a.data,totalCount:a.total}),u(0))}catch(a){if(!e.aborted){const e=a instanceof Error?a:new Error("Failed to load pets");g<s?u((e=>e+1)):h(e)}}finally{e.aborted||d(!1)}})(),()=>{p.current&&p.current.abort()})),[t.page,t.pageSize,r.sortField,r.sortOrder,g,s]),{data:n,loading:l,error:c}}(E.v.getPets(),r,O);(0,a.useEffect)((()=>{const e=sessionStorage.getItem(L),t=sessionStorage.getItem(J),r=sessionStorage.getItem(M),a=sessionStorage.getItem(z);e&&R(JSON.parse(e)),t&&P(JSON.parse(t)),r&&B(r),a&&W(JSON.parse(a))}),[]);const X=(0,a.useCallback)((t=>{e("detail/".concat(t))}),[e]),Z=(0,a.useCallback)((e=>{R((t=>{const r=t.sortField===e&&"asc"===t.sortOrder?"desc":"asc",a={sortField:e,sortOrder:r};return sessionStorage.setItem(L,JSON.stringify(a)),a}))}),[]),_=(0,a.useCallback)(((e,t)=>(0,I.jsx)(s.A,{active:O.sortField===e,direction:O.sortField===e?O.sortOrder:"asc",onClick:()=>Z(e),children:t})),[O.sortField,O.sortOrder,Z]),K=(0,a.useCallback)((e=>{W((t=>{const r=t.includes(e)?t.filter((t=>t!==e)):[...t,e];return sessionStorage.setItem(z,JSON.stringify(r)),r})),P((e=>({...e,page:0})))}),[]),Q=(0,a.useMemo)((()=>null!==q&&void 0!==q&&q.rows?q.rows.filter((e=>{const t=e.name.toLowerCase().includes(N.toLowerCase()),r=0===D.length||D.includes(e.kind);return t&&r})):[]),[null===q||void 0===q?void 0:q.rows,N,D]),U=Q.length;return H?(0,I.jsx)(n.A,{}):V?(0,I.jsx)(o.A,{sx:{p:3},children:(0,I.jsxs)(l.A,{severity:"error",children:[(0,I.jsx)(d.A,{children:t("home.error.title","Error Loading Pets")}),t("home.error.message","Unable to load pets. Please check your connection and try again."),(0,I.jsx)(o.A,{sx:{mt:2},children:(0,I.jsx)(c.A,{variant:"contained",onClick:()=>window.location.reload(),children:t("home.error.retry","Retry")})})]})}):(0,I.jsxs)(h.A,{pt:2,spacing:2,children:[(0,I.jsx)(F,{maxPets:(null===q||void 0===q?void 0:q.totalCount)||0}),(0,I.jsx)(g.A,{sx:{p:2},children:(0,I.jsxs)(h.A,{spacing:2,children:[(0,I.jsx)(u.A,{fullWidth:!0,placeholder:t("home.search.placeholder","Search pets by name..."),value:N,onChange:e=>{const t=e.target.value;B(t),sessionStorage.setItem(M,t),P({...r,page:0})},inputProps:{"aria-label":t("home.search.ariaLabel","Search pets by name"),role:"searchbox"},InputProps:{startAdornment:(0,I.jsx)(p.A,{position:"start",children:(0,I.jsx)(y.A,{"aria-hidden":"true"})})}}),(0,I.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},role:"group","aria-label":t("home.filter.ariaLabel","Filter pets by type"),children:[(0,I.jsx)(k.A,{sx:{color:"text.secondary"},"aria-hidden":"true"}),(0,I.jsx)(m.A,{label:t("home.filter.dog","Dogs"),onClick:()=>K("dog"),color:D.includes("dog")?"primary":"default",variant:D.includes("dog")?"filled":"outlined","aria-pressed":D.includes("dog"),"aria-label":t("home.filter.dogAria","Filter by dogs")}),(0,I.jsx)(m.A,{label:t("home.filter.cat","Cats"),onClick:()=>K("cat"),color:D.includes("cat")?"primary":"default",variant:D.includes("cat")?"filled":"outlined","aria-pressed":D.includes("cat"),"aria-label":t("home.filter.catAria","Filter by cats")}),(0,I.jsx)(m.A,{label:t("home.filter.bird","Birds"),onClick:()=>K("bird"),color:D.includes("bird")?"primary":"default",variant:D.includes("bird")?"filled":"outlined","aria-pressed":D.includes("bird"),"aria-label":t("home.filter.birdAria","Filter by birds")}),(N||D.length>0)&&(0,I.jsx)(m.A,{label:t("home.filter.clear","Clear All"),onClick:()=>{B(""),W([]),sessionStorage.removeItem(M),sessionStorage.removeItem(z)},variant:"outlined",onDelete:()=>{B(""),W([]),sessionStorage.removeItem(M),sessionStorage.removeItem(z)},"aria-label":t("home.filter.clearAria","Clear all filters and search")})]})]})}),(0,I.jsx)(x.A,{component:g.A,children:(0,I.jsxs)(b.A,{sx:{minWidth:650},"aria-label":t("home.table.ariaLabel","Pet list table"),children:[(0,I.jsx)(A.A,{children:(0,I.jsxs)(j.A,{children:[(0,I.jsx)(f.A,{children:_("name",t("home.table.header.name"))}),(0,I.jsx)(f.A,{align:"right",children:_("kind",t("home.table.header.kind"))}),(0,I.jsx)(f.A,{align:"right",children:_("weight",t("home.table.header.weight"))}),(0,I.jsx)(f.A,{align:"right",children:_("height",t("home.table.header.height"))}),(0,I.jsx)(f.A,{align:"right",children:_("length",t("home.table.header.length"))}),(0,I.jsx)(f.A,{align:"right",children:t("home.table.header.health","Health")})]})}),(0,I.jsx)(S.A,{children:H?(0,I.jsx)(j.A,{children:(0,I.jsx)(f.A,{colSpan:6,align:"center",children:(0,I.jsx)(n.A,{})})}):Q.map((e=>(0,I.jsx)(T,{pet:e,onRowClick:X},e.id)))})]})}),(0,I.jsx)(w.A,{component:"div",rowsPerPageOptions:[5,10,15,25],count:U,page:r.page,rowsPerPage:r.pageSize,onPageChange:(e,t)=>{const a={...r,page:t};P(a),sessionStorage.setItem(J,JSON.stringify(a))},onRowsPerPageChange:e=>{const t={page:0,pageSize:e.target.value};P(t),sessionStorage.setItem(J,JSON.stringify(t))}})]})}}}]);
//# sourceMappingURL=341.9f2342c1.chunk.js.map